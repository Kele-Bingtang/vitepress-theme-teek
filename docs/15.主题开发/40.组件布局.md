---
title: 组件结构
date: 2025-03-17 21:27:53
permalink: /develop/components
---

一个项目的功能组件虽然有很多，但是入口组件只有一个，如果您不知道这些功能组件都在哪里执行，不妨从入口组件开始解读，一步一步往下延伸，最终把项目功能吃透。

Teeker 在首页、文章页、空白页、全局都写了组件来实现功能，但是这些组件并不是分开引入，而是统一在 `src/layout/index.vue` 里引入，并派发到 Vitepress 不同的插槽，如：

```vue
<!-- src/layout/index.vue -->
<script setup lang="ts" name="TeekerLayout">
import DefaultTheme from "vitepress/theme";
import { useData } from "vitepress";
import {
  RightBottomButton,
  Notice,
  HomeBanner,
  HomePostList,
  HomeInfo,
  Footer,
  ArticleAnalyze,
  Comment,
  ArchivesPage,
  CataloguePage,
} from "../components";
const { Layout } = DefaultTheme;
const { theme } = useData();
const { tkTheme = true } = theme.value;
</script>
<template>
  <template v-if="tkTheme">
    <ClientOnly>
      <!-- 全局 -->
      <RightBottomButton />
      <Notice />
    </ClientOnly>

    <Layout :class="ns.b()">
      <template #home-hero-before>
        <slot name="home-hero-before" />
        <slot name="teeker-home-before" />
        <ClientOnly>
          <!-- 自定义首页 -->
          <HomeBanner />
          <HomePostList />
          <HomeInfo />
        </ClientOnly>
        <slot name="teeker-home-after" />
      </template>

      <template #layout-bottom>
        <!-- 底部 -->
        <Footer v-if="isHomePage()" />
        <slot name="layout-bottom" />
      </template>

      <template #doc-before>
        <slot name="doc-before" />
        <!--文章页信息 -->
        <ArticleAnalyze />
      </template>

      <template #doc-after>
        <slot name="doc-after" />
        <!-- 评论区 -->
        <Comment />
      </template>

      <template #page-top>
        <slot name="page-top" />
        <ArchivesPage />
        <CataloguePage />
      </template>

      <!-- 其他 VP 插槽 -->
      <template v-for="(_, name) in $slots" :key="name" #[name]="slotData">
        <slot :name="name" v-bind="slotData"></slot>
      </template>
    </Layout>
  </template>
  <template v-else>
    <Layout>
      <template v-for="(_, name) in $slots" :key="name" #[name]="slotData">
        <slot :name="name" v-bind="slotData"></slot>
      </template>
    </Layout>
  </template>
</template>
```

## 目录结构

```sh
src
├─ layout                        # 布局组件（入口组件）
├─ configProvider.ts            # 入口文件
│
├─ components
│  ├─ ArchivesPage               # 归档页组件
│  ├─ ArticleAnalyze             # 文章页分析组件
│  ├─ ArticleBreadcrumb          # 文章页面包屑组件
│  ├─ ArticleImagePreview        # 图片预览组件
│  ├─ ArticleInfo                # 文章信息组件
│  ├─ ArticlePageStyle           # 文章页样式组件
│  ├─ base                       # 基础样式组件
│  ├─ BodyBgImage                # Body 背景图片组件
│  ├─ CataloguePage              # 目录页组件
│  ├─ CodeBlockToggle            # 代码块加强组件
│  ├─ CommentArtalk              # Artalk 评论区组件
│  ├─ CommentGiscus              # Giscus 评论区组件
│  ├─ CommentTwikoo              # Twikoo 评论区组件
│  ├─ CommentWaline              # Waline 评论区组件
│  ├─ Footer                     # 底部组件
│  ├─ HomeBanner                 # 首页 Banner 组件
│  ├─ HomeCard                   # 首页卡片组件
│  ├─ HomeCategoryCard           # 首页分类卡片组件
│  ├─ HomeDocAnalysisCard        # 首页文章分析卡片组件
│  ├─ HomeFriendLinkCard         # 首页友情链接卡片组件
│  ├─ HomeFullscreenWallpaper    # 壁纸模式组件
│  ├─ HomeInfo                   # 首页信息组件
│  ├─ HomeMyCard                 # 首页我的卡片组件
│  ├─ HomePostList               # 首页文章列表组件
│  ├─ HomeTagCard                # 首页标签卡片组件
│  ├─ HomeTopArticleCard         # 首页置顶文章卡片组件
│  ├─ Icon                       # 图标组件
│  ├─ ImageViewer                # 图片查看器组件
│  ├─ Notice                     # 公告组件
│  ├─ Pagination                 # 分页组件
│  └─ RightBottomButton          # 右下角按钮组组件
```

Vitepress 从 `src/index.ts`（入口文件）解析 `Layout` 函数，该函数返回 `src/layout.index.vue` 组件（入口组件），该入口组件将 Teeker 的各个功能组件派发到 Vitepress 不同的插槽，最终形成现在的 Teeker 主题。

## 配置项获取

在开发功能组件的时候，Teeker 往往不会在组件内部固定功能，而是由用户通过配置项来开关功能，也叫插拔式设计。

在 Vitepress 中，配置项往往有 2 种方式配置：

1.  `.vitepress/config.ts` 全局配置
2.  Markdown 的 `frontmatter` 局部配置

如果2 种方式都配置，那么 Markdown 的 `frontmatter` 配置优先级更改，比如 Teeker 的评论区功能，用户可以给每一个 Markdown 配置不同的评论区。

配置项例子如：

```vue
<script setup lang="ts">
import { useData } from "vitepress";
import { computed } from "vue";
const { theme, frontmatter } = useData();

// Banner 配置项
const {
  bgStyle = "default",
  imgSrc,
  imgInterval = 15000,
  imgShuffle = false,
  imgWaves = true,
  mask = true,
  maskBg = "rgba(0, 0, 0, 0.4)",
  defaultBgColor = "#e 5 e 5 e 5",
  textColor,
  titleFontSize = "3.2rem",
  descFontSize = "1.4rem",
  descStyle = "default",
  description = [],
  switchTime = 4000,
  switchShuffle = false,
  typesInTime = 200,
  typesOutTime = 100,
  typesNextTime = 800,
  typesShuffle = false,
  features = [],
} = { ...theme.banner, ...frontmatter.value.tk?.banner };
</script>
```

这样编写方式既支持 2 种方式配置，也支持给配置项添加默认值。 2 种配置方式如下：

::: code-group

```ts [config]
// .vitepress/config.ts
import tkThemeConfig from "vitepress-theme-teeker/config";

const tkConfig = tkThemeConfig({
 banner: {
   enabled: true,
   bgStyle: "bigImg", // Banner 背景风格：default 为纯色背景，bigImg 为大图背景，grid 为网格背景
   defaultBgColor: "#e5e5e5", // Banner 背景色，bgStyle 为 default 时生效
   imgSrc: ["/img/bg1.jpg", "/img/bg2.png"], // Banner 大图链接。bgStyle 为 bigImg 时生效
   imgInterval: 15000, // 当多张大图时（imgSrc 为数组），设置切换时间，单位：毫秒
   imgShuffle: false, // 大图是否随机切换，为 false 时按顺序切换，bgStyle 为 bigImg 时生效
   imgWaves: true, // 是否开启 Banner 大图波浪纹，bgStyle 为 bigImg 时生效
   mask: true, // Banner 大图遮罩，bgStyle 为 bigImg 时生效
   maskBg: "rgba(0, 0, 0, 0.4)", // Banner 大图遮罩颜色，如果为数字，则是 rgba(0, 0, 0, ${maskBg})，如果为字符串，则作为背景色
   textColor: "#ffffff", // Banner 字体颜色，bgStyle 为 default 时为 '#000000'，其他为 '#ffffff'
   titleFontSize: "3.2rem", // 标题字体大小
   descFontSize: "1.4rem", // 描述字体大小
   descStyle: "types", // 描述信息风格：default 为纯文字渲染风格（如果 description 为数组，则取第一个），types 为文字打印风格，switch 为文字切换风格
   description: ["故事由我书写，旅程由你见证，传奇由她聆听 —— 来自 Young Kbt", "积跬步以至千里，致敬每个爱学习的你 —— 来自 Evan Xu"], // 描述信息
   switchTime: 4000, // 描述信息切换间隔时间，单位：毫秒。descStyle 为 switch 时生效
   switchShuffle: false, // 描述信息是否随机切换，为 false 时按顺序切换。descStyle 为 switch 时生效
   typesInTime: 200, // 输出一个文字的时间，单位：毫秒。descStyle 为 types 时生效
   typesOutTime: 100, // 删除一个文字的时间，单位：毫秒。descStyle 为 types 时生效
   typesNextTime: 800, // 打字与删字的间隔时间，单位：毫秒。descStyle 为 types 时生效
   typesShuffle: false, // 描述信息是否随机打字，为 false 时按顺序打字，descStyle 为 types 时生效
 };
});
```

```yaml [index.md]
---
tk:
  banner:
    enabled: true,
    bgStyle: "bigImg"
    defaultBgColor: "#e5e5e5",
    imgSrc:
      - /img/bg1.jpg
      - /img/bg2.jpg
    imgInterval: 15000
    imgShuffle: false
    mask: true
    maskBg: "rgba(0, 0, 0, 0.4)"
    textColor: "#ffffff"
    titleFontSize: "3.2rem"
    descFontSize: "1.4rem"
    descStyle: "types"
    description:
      - 故事由我书写，旅程由你见证，传奇由她聆听 —— 来自 Young Kbt
      - 积跬步以至千里，致敬每个爱学习的你 —— 来自 Evan Xu
    switchTime: 4000
    switchShuffle: false
    typesInTime: 200
    typesOutTime: 100
    typesNextTime: 800
    typesShuffle: false
---
```

:::
